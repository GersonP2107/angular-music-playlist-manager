<footer
    class="fixed bottom-0 left-0 w-full h-20 md:h-24 bg-black/95 border-t border-zinc-900 px-2 md:px-4 flex items-center justify-between text-white z-50 backdrop-blur-lg">

    <!-- Left: Now Playing -->
    <div class="flex items-center w-full md:w-[30%] min-w-0 md:min-w-[180px] flex-1">
        <!-- Placeholder for Album Art -->
        <div
            class="relative h-12 w-12 md:h-14 md:w-14 bg-zinc-800 rounded shadow-lg mr-3 flex-shrink-0 overflow-hidden group border border-white/5">
            @if (player.currentTrack(); as track) {
            <img [src]="track.artworkUrl || '/images/album-placeholder.png'" alt="Cover"
                class="object-cover w-full h-full opacity-90 group-hover:opacity-100 transition-opacity">
            } @else {
            <div class="w-full h-full bg-zinc-800 flex items-center justify-center">
                <svg class="w-6 h-6 text-zinc-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" />
                </svg>
            </div>
            }
        </div>
        <div class="flex flex-col overflow-hidden mr-2 md:mr-4 min-w-0">
            @if (player.currentTrack(); as track) {
            <span class="text-sm font-semibold truncate hover:underline cursor-pointer">{{ track.title }}</span>
            <span
                class="text-xs text-zinc-400 hover:underline cursor-pointer group-hover:text-white transition-colors truncate">{{
                track.artist }}</span>
            } @else {
            <span class="text-sm font-semibold text-zinc-500">No playing</span>
            }
        </div>
        <!-- Like Button -->
        <button class="transition hidden sm:block mx-2 hover:scale-110 active:scale-95"
            [class.text-green-500]="isLiked()" [class.text-zinc-400]="!isLiked()" (click)="toggleLike()"
            title="Save to your Liked Songs">
            <svg role="img" height="16" width="16" viewBox="0 0 24 24" [attr.fill]="isLiked() ? 'currentColor' : 'none'"
                [attr.stroke]="isLiked() ? 'none' : 'currentColor'" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <path
                    d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z">
                </path>
            </svg>
        </button>
    </div>

    <!-- Center: Controls -->
    <div
        class="flex flex-col items-center max-w-none md:max-w-[45%] w-auto flex-none md:flex-1 px-2 md:px-4 gap-1 md:gap-2 absolute left-1/2 -translate-x-1/2 md:static md:translate-x-0 bottom-3 md:bottom-auto">
        <div class="flex items-center gap-4 md:gap-6 mb-1 filter drop-shadow-md">
            <!-- Shuffle (Hidden on mobile) -->
            <button class="text-zinc-400 hover:text-white transition hidden md:block" title="Enable Shuffle"
                [class.text-green-500]="player.isShuffle()">
                <svg role="img" height="16" width="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="16 3 21 3 21 8"></polyline>
                    <line x1="4" y1="20" x2="21" y2="3"></line>
                    <polyline points="21 16 21 21 16 21"></polyline>
                    <line x1="15" y1="15" x2="21" y2="21"></line>
                    <line x1="4" y1="4" x2="9" y2="9"></line>
                </svg>
            </button>

            <!-- Previous -->
            <button class="text-zinc-400 hover:text-white transition hidden sm:block" title="Previous"
                (click)="player.prev()">
                <svg role="img" height="16" width="16" viewBox="0 0 24 24" fill="currentColor" stroke="none">
                    <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"></path>
                </svg>
            </button>

            <!-- Play/Pause -->
            <button (click)="player.toggle()"
                class="bg-white text-black rounded-full h-10 w-10 md:h-8 md:w-8 flex items-center justify-center hover:scale-105 transition active:scale-95 shadow-md">
                @if (player.isPlaying()) {
                <svg role="img" height="18" width="18" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>
                </svg>
                } @else {
                <svg role="img" height="18" width="18" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M8 5v14l11-7z"></path>
                </svg>
                }
            </button>

            <!-- Next -->
            <button class="text-zinc-400 hover:text-white transition hidden sm:block" title="Next"
                (click)="player.next()">
                <svg role="img" height="16" width="16" viewBox="0 0 24 24" fill="currentColor" stroke="none">
                    <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"></path>
                </svg>
            </button>

            <!-- Repeat (Hidden on mobile) -->
            <button class="text-zinc-400 hover:text-white transition hidden md:block" title="Enable Repeat"
                [class.text-green-500]="player.isRepeat()">
                <svg role="img" height="16" width="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="17 1 21 5 17 9"></polyline>
                    <path d="M3 11V9a4 4 0 0 1 4-4h14"></path>
                    <polyline points="7 23 3 19 7 15"></polyline>
                    <path d="M21 13v2a4 4 0 0 1-4 4H3"></path>
                </svg>
            </button>
        </div>

        <div class="hidden md:flex items-center w-full gap-2 group w-[300px] lg:w-[400px]">
            <span class="text-[11px] text-zinc-400 min-w-[30px] text-right font-light">{{
                formatTime(player.currentTime()) }}</span>
            <input type="range" min="0" max="100" [value]="progress" (input)="onSeek($event)"
                [style.background]="'linear-gradient(to right, #1db954 0%, #1db954 ' + progress + '%, #404040 ' + progress + '%, #404040 100%)'"
                class="w-full h-1 rounded-lg appearance-none cursor-pointer accent-white hover:accent-green-500 focus:outline-none">
            <span class="text-[11px] text-zinc-400 min-w-[30px] font-light">{{ formatTime(player.duration()) }}</span>
        </div>
    </div>

    <!-- Right: Volume/Options (Hidden on mobile) -->
    <div class="hidden md:flex items-center justify-end w-[30%] gap-3 px-2">
        <!-- Queue -->
        <button class="text-zinc-400 hover:text-white transition" title="Queue">
            <svg role="img" height="16" width="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="8" y1="6" x2="21" y2="6"></line>
                <line x1="8" y1="12" x2="21" y2="12"></line>
                <line x1="8" y1="18" x2="21" y2="18"></line>
                <line x1="3" y1="6" x2="3.01" y2="6"></line>
                <line x1="3" y1="12" x2="3.01" y2="12"></line>
                <line x1="3" y1="18" x2="3.01" y2="18"></line>
            </svg>
        </button>

        <div class="flex items-center gap-2 w-24 lg:w-32 group">
            <button class="text-zinc-400 hover:text-white transition" title="Mute"
                (click)="player.setVolume(player.volume() === 0 ? 0.5 : 0)">
                @if (player.volume() === 0) {
                <svg role="img" height="16" width="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="1" y1="1" x2="23" y2="23"></line>
                    <path d="M9 9v6a4 4 0 0 0 4 4v-2"></path>
                </svg>
                } @else {
                <svg role="img" height="16" width="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                    <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                </svg>
                }
            </button>
            <input type="range" min="0" max="100" [value]="player.volume() * 100" (input)="onVolumeChange($event)"
                [style.background]="'linear-gradient(to right, #ffffff 0%, #ffffff ' + (player.volume() * 100) + '%, #404040 ' + (player.volume() * 100) + '%, #404040 100%)'"
                class="w-full h-1 rounded-lg appearance-none cursor-pointer accent-white volume-slider">
        </div>
    </div>

    <!-- Mobile specific controls (Right side) -->
    <div class="flex md:hidden items-center gap-4">
        <!-- Floating play button overlay logic usually goes here or main play button in center -->
        <button class="text-zinc-400 hover:text-white transition" (click)="player.toggle()">
            @if (player.isPlaying()) {
            <svg role="img" height="20" width="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="6" y="4" width="4" height="16"></rect>
                <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
            } @else {
            <svg role="img" height="20" width="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            </svg>
            }
        </button>
    </div>
</footer>